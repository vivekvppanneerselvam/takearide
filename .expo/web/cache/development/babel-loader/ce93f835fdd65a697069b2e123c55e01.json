{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = connectToState;\nexports.InjectedProps = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _ccfieldformatter = _interopRequireDefault(require(\"./ccfieldformatter\"));\n\nvar _ccfieldvalidator = _interopRequireDefault(require(\"./ccfieldvalidator\"));\n\nvar _jsxFileName = \"D:\\\\WS\\\\reactws\\\\takearide\\\\src\\\\modules\\\\payment\\\\component\\\\connecttostate.js\";\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nvar InjectedProps = {\n  focused: _propTypes.default.string,\n  values: _propTypes.default.object.isRequired,\n  status: _propTypes.default.object.isRequired,\n  onFocus: _propTypes.default.func.isRequired,\n  onChange: _propTypes.default.func.isRequired,\n  onBecomeEmpty: _propTypes.default.func.isRequired,\n  onBecomeValid: _propTypes.default.func.isRequired,\n  requiresName: _propTypes.default.bool,\n  requiresCVC: _propTypes.default.bool,\n  requiresPostalCode: _propTypes.default.bool\n};\nexports.InjectedProps = InjectedProps;\n\nfunction connectToState(CreditCardInput) {\n  var StateConnection = function (_Component) {\n    (0, _inherits2.default)(StateConnection, _Component);\n\n    var _super = _createSuper(StateConnection);\n\n    function StateConnection() {\n      var _this;\n\n      (0, _classCallCheck2.default)(this, StateConnection);\n      _this = _super.call(this);\n\n      _this.componentDidMount = function () {\n        return setTimeout(function () {\n          _this.props.autoFocus && _this.focus(\"number\");\n        });\n      };\n\n      _this.setValues = function (values) {\n        var newValues = _objectSpread({}, _this.state.values, {}, values);\n\n        var displayedFields = _this._displayedFields();\n\n        var formattedValues = new _ccfieldformatter.default(displayedFields).formatValues(newValues);\n        var validation = new _ccfieldvalidator.default(displayedFields, _this.props.validatePostalCode).validateValues(formattedValues);\n\n        var newState = _objectSpread({\n          values: formattedValues\n        }, validation);\n\n        _this.setState(newState);\n\n        _this.props.onChange(newState);\n      };\n\n      _this.focus = function () {\n        var field = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"number\";\n\n        _this.setState({\n          focused: field\n        });\n      };\n\n      _this._displayedFields = function () {\n        var _this$props = _this.props,\n            requiresName = _this$props.requiresName,\n            requiresCVC = _this$props.requiresCVC,\n            requiresPostalCode = _this$props.requiresPostalCode;\n        return [\"number\", \"expiry\", requiresCVC ? \"cvc\" : null, requiresName ? \"name\" : null, requiresPostalCode ? \"postalCode\" : null];\n      };\n\n      _this._focusPreviousField = function (field) {\n        var displayedFields = _this._displayedFields();\n\n        var fieldIndex = displayedFields.indexOf(field);\n        var previousField = displayedFields[fieldIndex - 1];\n        if (previousField) _this.focus(previousField);\n      };\n\n      _this._focusNextField = function (field) {\n        if (field === \"name\") return;\n\n        var displayedFields = _this._displayedFields();\n\n        var fieldIndex = displayedFields.indexOf(field);\n        var nextField = displayedFields[fieldIndex + 1];\n        if (nextField) _this.focus(nextField);\n      };\n\n      _this._change = function (field, value) {\n        _this.setValues((0, _defineProperty2.default)({}, field, value));\n      };\n\n      _this._onFocus = function (field) {\n        _this.focus(field);\n\n        _this.props.onFocus(field);\n      };\n\n      _this.state = {\n        focused: \"\",\n        values: {},\n        status: {}\n      };\n      return _this;\n    }\n\n    (0, _createClass2.default)(StateConnection, [{\n      key: \"render\",\n      value: function render() {\n        return _react.default.createElement(CreditCardInput, (0, _extends2.default)({}, this.props, this.state, {\n          onFocus: this._onFocus,\n          onChange: this._change,\n          onBecomeEmpty: this._focusPreviousField,\n          onBecomeValid: this._focusNextField,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 9\n          }\n        }));\n      }\n    }]);\n    return StateConnection;\n  }(_react.Component);\n\n  StateConnection.propTypes = {\n    autoFocus: _propTypes.default.bool,\n    onChange: _propTypes.default.func.isRequired,\n    onFocus: _propTypes.default.func,\n    requiresName: _propTypes.default.bool,\n    requiresCVC: _propTypes.default.bool,\n    requiresPostalCode: _propTypes.default.bool,\n    validatePostalCode: _propTypes.default.func\n  };\n  StateConnection.defaultProps = {\n    autoFocus: false,\n    onChange: function onChange() {},\n    onFocus: function onFocus() {},\n    requiresName: false,\n    requiresCVC: true,\n    requiresPostalCode: false,\n    validatePostalCode: function validatePostalCode() {\n      var postalCode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      return postalCode.match(/^\\d{6}$/) ? \"valid\" : postalCode.length > 6 ? \"invalid\" : \"incomplete\";\n    }\n  };\n  return StateConnection;\n}","map":{"version":3,"sources":["D:/WS/reactws/takearide/src/modules/payment/component/connecttostate.js"],"names":["InjectedProps","focused","PropTypes","string","values","object","isRequired","status","onFocus","func","onChange","onBecomeEmpty","onBecomeValid","requiresName","bool","requiresCVC","requiresPostalCode","connectToState","CreditCardInput","StateConnection","componentDidMount","setTimeout","props","autoFocus","focus","setValues","newValues","state","displayedFields","_displayedFields","formattedValues","CCFieldFormatter","formatValues","validation","CCFieldValidator","validatePostalCode","validateValues","newState","setState","field","_focusPreviousField","fieldIndex","indexOf","previousField","_focusNextField","nextField","_change","value","_onFocus","Component","propTypes","defaultProps","postalCode","match","length"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport CCFieldFormatter from \"./ccfieldformatter\";\r\nimport CCFieldValidator from \"./ccfieldvalidator\";\r\n//import compact from \"lodash.compact\";\r\n\r\nexport const InjectedProps = {\r\n  focused: PropTypes.string,\r\n  values: PropTypes.object.isRequired,\r\n  status: PropTypes.object.isRequired,\r\n  onFocus: PropTypes.func.isRequired,\r\n  onChange: PropTypes.func.isRequired,\r\n  onBecomeEmpty: PropTypes.func.isRequired,\r\n  onBecomeValid: PropTypes.func.isRequired,\r\n  requiresName: PropTypes.bool,\r\n  requiresCVC: PropTypes.bool,\r\n  requiresPostalCode: PropTypes.bool,\r\n};\r\n\r\nexport default function connectToState(CreditCardInput) {\r\n  class StateConnection extends Component {\r\n    static propTypes = {\r\n      autoFocus: PropTypes.bool,\r\n      onChange: PropTypes.func.isRequired,\r\n      onFocus: PropTypes.func,\r\n      requiresName: PropTypes.bool,\r\n      requiresCVC: PropTypes.bool,\r\n      requiresPostalCode: PropTypes.bool,\r\n      validatePostalCode: PropTypes.func,\r\n    };\r\n\r\n    static defaultProps = {\r\n      autoFocus: false,\r\n      onChange: () => {},\r\n      onFocus: () => {},\r\n      requiresName: false,\r\n      requiresCVC: true,\r\n      requiresPostalCode: false,\r\n      validatePostalCode: (postalCode = \"\") => {\r\n        return postalCode.match(/^\\d{6}$/) ? \"valid\" :\r\n               postalCode.length > 6 ? \"invalid\" :\r\n               \"incomplete\";\r\n      },\r\n    };\r\n\r\n    constructor() {\r\n      super();\r\n      this.state = {\r\n        focused: \"\",\r\n        values: {},\r\n        status: {},\r\n      };\r\n    }\r\n\r\n    componentDidMount = () => setTimeout(() => { // Hacks because componentDidMount happens before component is rendered\r\n      this.props.autoFocus && this.focus(\"number\");\r\n    });\r\n\r\n    setValues = values => {\r\n      const newValues = { ...this.state.values, ...values };\r\n      const displayedFields = this._displayedFields();\r\n      const formattedValues = (new CCFieldFormatter(displayedFields)).formatValues(newValues);\r\n      const validation = (new CCFieldValidator(displayedFields, this.props.validatePostalCode)).validateValues(formattedValues);\r\n      const newState = { values: formattedValues, ...validation };\r\n\r\n      this.setState(newState);\r\n      this.props.onChange(newState);\r\n    };\r\n\r\n    focus = (field = \"number\") => {\r\n      this.setState({ focused: field });\r\n    };\r\n\r\n    _displayedFields = () => {\r\n      const { requiresName, requiresCVC, requiresPostalCode } = this.props;\r\n      return [\r\n        \"number\",\r\n        \"expiry\",\r\n        requiresCVC ? \"cvc\" : null,\r\n        requiresName ? \"name\" : null,\r\n        requiresPostalCode ? \"postalCode\" : null,\r\n      ];\r\n    };\r\n\r\n    _focusPreviousField = field => {\r\n      const displayedFields = this._displayedFields();\r\n      const fieldIndex = displayedFields.indexOf(field);\r\n      const previousField = displayedFields[fieldIndex - 1];\r\n      if (previousField) this.focus(previousField);\r\n    };\r\n\r\n    _focusNextField = field => {\r\n      if (field === \"name\") return;\r\n      // Should not focus to the next field after name (e.g. when requiresName & requiresPostalCode are true\r\n      // because we can't determine if the user has completed their name or not)\r\n\r\n      const displayedFields = this._displayedFields();\r\n      const fieldIndex = displayedFields.indexOf(field);\r\n      const nextField = displayedFields[fieldIndex + 1];\r\n      if (nextField) this.focus(nextField);\r\n    };\r\n\r\n    _change = (field, value) => {\r\n      this.setValues({ [field]: value });\r\n    };\r\n\r\n    _onFocus = (field) => {\r\n      this.focus(field);\r\n      this.props.onFocus(field);\r\n    };\r\n\r\n    render() {\r\n      return (\r\n        <CreditCardInput\r\n          {...this.props}\r\n          {...this.state}\r\n          onFocus={this._onFocus}\r\n          onChange={this._change}\r\n          onBecomeEmpty={this._focusPreviousField}\r\n          onBecomeValid={this._focusNextField} />\r\n      );\r\n    }\r\n  }\r\n\r\n  return StateConnection;\r\n}"]},"metadata":{},"sourceType":"script"}