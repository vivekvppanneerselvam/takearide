{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _utilities = require(\"./utilities\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar limitLength = function limitLength() {\n  var string = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n  var maxLength = arguments.length > 1 ? arguments[1] : undefined;\n  return string.substr(0, maxLength);\n};\n\nvar addGaps = function addGaps() {\n  var string = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n  var gaps = arguments.length > 1 ? arguments[1] : undefined;\n  var offsets = [0].concat(gaps).concat([string.length]);\n  return offsets.map(function (end, index) {\n    if (index === 0) return \"\";\n    var start = offsets[index - 1];\n    return string.substr(start, end - start);\n  }).filter(function (part) {\n    return part !== \"\";\n  }).join(\" \");\n};\n\nvar FALLBACK_CARD = {\n  gaps: [4, 8, 12],\n  lengths: [16],\n  code: {\n    size: 3\n  }\n};\n\nvar CCFieldFormatter = function CCFieldFormatter(displayedFields) {\n  var _this = this;\n\n  (0, _classCallCheck2.default)(this, CCFieldFormatter);\n\n  this.formatValues = function (values) {\n    var card = values.number || FALLBACK_CARD;\n    return _lodash.default.pick({\n      type: card.type,\n      number: _this._formatNumber(values.number, card),\n      expiry: _this._formatExpiry(values.expiry),\n      cvc: _this._formatCVC(values.cvc, card),\n      name: (0, _utilities.removeLeadingSpaces)(values.name),\n      postalCode: (0, _utilities.removeNonNumber)(values.postalCode)\n    }, _this._displayedFields);\n  };\n\n  this._formatNumber = function (number, card) {\n    var numberSanitized = (0, _utilities.removeNonNumber)(number);\n    var maxLength = card.lengths[card.lengths.length - 1];\n    var lengthSanitized = limitLength(numberSanitized, maxLength);\n    var formatted = addGaps(lengthSanitized, card.gaps);\n    return formatted;\n  };\n\n  this._formatExpiry = function (expiry) {\n    var sanitized = limitLength((0, _utilities.removeNonNumber)(expiry), 4);\n\n    if (sanitized.match(/^[2-9]$/)) {\n      return \"0\" + sanitized;\n    }\n\n    if (sanitized.length > 2) {\n      return sanitized.substr(0, 2) + \"/\" + sanitized.substr(2, sanitized.length);\n    }\n\n    return sanitized;\n  };\n\n  this._formatCVC = function (cvc, card) {\n    var maxCVCLength = card.code.size;\n    return limitLength((0, _utilities.removeNonNumber)(cvc), maxCVCLength);\n  };\n\n  this._displayedFields = [].concat((0, _toConsumableArray2.default)(displayedFields), [\"type\"]);\n};\n\nexports.default = CCFieldFormatter;","map":{"version":3,"sources":["D:/WS/reactws/takearide/src/modules/payment/component/ccfieldformatter.js"],"names":["limitLength","string","maxLength","substr","addGaps","gaps","offsets","concat","length","map","end","index","start","filter","part","join","FALLBACK_CARD","lengths","code","size","CCFieldFormatter","displayedFields","formatValues","values","card","number","_","pick","type","_formatNumber","expiry","_formatExpiry","cvc","_formatCVC","name","postalCode","_displayedFields","numberSanitized","lengthSanitized","formatted","sanitized","match","maxCVCLength"],"mappings":"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","sourcesContent":["//import valid from \"card-validator\";\r\nimport { removeNonNumber, removeLeadingSpaces } from \"./utilities\";\r\nimport _ from \"lodash\";\r\n\r\nconst limitLength = (string = \"\", maxLength) => string.substr(0, maxLength);\r\nconst addGaps = (string = \"\", gaps) => {\r\n  const offsets = [0].concat(gaps).concat([string.length]);\r\n\r\n  return offsets.map((end, index) => {\r\n    if (index === 0) return \"\";\r\n    const start = offsets[index - 1];\r\n    return string.substr(start, end - start);\r\n  }).filter(part => part !== \"\").join(\" \");\r\n};\r\n\r\nconst FALLBACK_CARD = { gaps: [4, 8, 12], lengths: [16], code: { size: 3 } };\r\nexport default class CCFieldFormatter {\r\n  constructor(displayedFields) {\r\n    this._displayedFields = [...displayedFields, \"type\"];\r\n  }\r\n\r\n  formatValues = (values) => {\r\n    const card = /* valid.number( */values.number/* ).card  */|| FALLBACK_CARD;\r\n\r\n    return _.pick({\r\n      type: card.type,\r\n      number: this._formatNumber(values.number, card),\r\n      expiry: this._formatExpiry(values.expiry),\r\n      cvc: this._formatCVC(values.cvc, card),\r\n      name: removeLeadingSpaces(values.name),\r\n      postalCode: removeNonNumber(values.postalCode),\r\n    }, this._displayedFields);\r\n  };\r\n\r\n  _formatNumber = (number, card) => {\r\n    const numberSanitized = removeNonNumber(number);\r\n    const maxLength = card.lengths[card.lengths.length - 1];\r\n    const lengthSanitized = limitLength(numberSanitized, maxLength);\r\n    const formatted = addGaps(lengthSanitized, card.gaps);\r\n    return formatted;\r\n  };\r\n\r\n  _formatExpiry = (expiry) => {\r\n    const sanitized = limitLength(removeNonNumber(expiry), 4);\r\n    if (sanitized.match(/^[2-9]$/)) { return `0${sanitized}`; }\r\n    if (sanitized.length > 2) { return `${sanitized.substr(0, 2)}/${sanitized.substr(2, sanitized.length)}`; }\r\n    return sanitized;\r\n  };\r\n\r\n  _formatCVC = (cvc, card) => {\r\n    const maxCVCLength = card.code.size;\r\n    return limitLength(removeNonNumber(cvc), maxCVCLength);\r\n  };\r\n}"]},"metadata":{},"sourceType":"script"}